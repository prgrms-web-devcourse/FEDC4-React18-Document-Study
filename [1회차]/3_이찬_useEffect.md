ë¦¬ì•¡íŠ¸ í›…ì€ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì—ì„œë„ í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ì™€ ë™ì¼í•œ ê¸°ëŠ¥ë“¤ì„ ì œê³µí•˜ê¸° ìœ„í•´ì„œ ë‚˜ì˜¨ ê²ƒ

ë¦¬ì•¡íŠ¸ í›…ì€ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì˜ ë Œë”ë§ ê³¼ì • ì¤‘ê°„ì— ë¼ì–´ ë“¤ì–´ê°€ ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì¤Œ

í›…ì€ ë¬´ì¡°ê±´ í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì˜ ìµœìƒìœ„ ë ˆë²¨ì—ì„œë§Œ í˜¸ì¶œí•´ì•¼í•œë‹¤(ì¡°ê±´ë¬¸ ê°™ì€ ê³³ì—ì„œ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤. í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•´ë„ ì•ˆëœë‹¤.)

---

ì‚¬ìš©ë²•

- ì™¸ë¶€ ì‹œìŠ¤í…œì— ì—°ê²°í•˜ê¸°
- ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ Effect ê°ì‹¸ê¸°
- Reactê°€ ì•„ë‹Œ ìœ„ì ¯ ì œì–´í•˜ê¸°
- Effectë¡œ ë°ì´í„° í˜ì¹­í•˜ê¸°
- ë°˜ì‘í˜• ì˜ì¡´ì„± ì§€ì •
- Effectì˜ ì´ì „ stateë¥¼ ê¸°ë°˜ìœ¼ë¡œ state ì—…ë°ì´íŠ¸í•˜ê¸°
- ë¶ˆí•„ìš”í•œ ê°ì²´ ì˜ì¡´ì„± ì œê±°í•˜ê¸°
- ë¶ˆí•„ìš”í•œ í•¨ìˆ˜ ì˜ì¡´ì„± ì œê±°í•˜ê¸°
- Effectì—ì„œ ìµœì‹  props ë° state ì½ê¸°
- ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ì— ì„œë¡œ ë‹¤ë¥¸ ì½˜í…ì¸  í‘œì‹œí•˜ê¸°

useEffect(setup, dependencies?)

ì§ì—­í•˜ë©´ sideEffect(ìˆœìˆ˜í•¨ìˆ˜ê°€ ì•„ë‹Œ í•¨ìˆ˜ê°€ ë°œìƒì‹œí‚¤ëŠ” ì•¡ì…˜)ë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ëœ»?

> ì»´í¬ë„ŒíŠ¸ì˜ ìµœìƒìœ„ ë ˆë²¨ì—ì„œ useEffectë¥¼ í˜¸ì¶œí•˜ì—¬ Effectë¥¼ ì„ ì–¸

```jsx
import { useEffect } from "react";
import { createConnection } from "./chat.js";

function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState("https://localhost:1234");

  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.connect();
    return () => {
      connection.disconnect();
    };
  }, [serverUrl, roomId]);
  // ...
}

// ì•¡ì…˜ì„ ì¼ìœ¼í‚¤ëŠ” í•¨ìˆ˜ë“¤ì„ ë‹¤ effectë¡œ ë¹¼ëŠ”ë“¯
```

useEffect(setup,dependencies?) ì´ë ‡ê²Œ êµ¬ì„±ì´ ë˜ê³ ,

setup í•¨ìˆ˜ëŠ” **_ì»´í¬ë„ŒíŠ¸ê°€ DOMì— ì¶”ê°€ë˜ë©´_** ì…‹ì—…í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

ì˜ì¡´ì„±ì˜ ë³€ê²½ë˜ì–´ ë¦¬ë Œë”ë§ì´ ë°œìƒí•˜ë©´, í´ë¦°ì—… í•¨ìˆ˜ê°€ ìˆëŠ” ê²½ìš°, ì´ì „ê°’(?)ìœ¼ë¡œ í´ë¦°ì—… í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ë‹¤ìŒ, ìƒˆ ê°’ìœ¼ë¡œ ì…‹ì—… í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

ì˜ì¡´ì„±ì€ props, state, ì»´í¬ë„ŒíŠ¸ **_ë‚´ë¶€_** ì—ì„œ ì§ì ‘ ì„ ì–¸í•œ ëª¨ë“  ë³€ìˆ˜ì™€ í•¨ìˆ˜ë¥¼ í¬í•¨ Object.is ë¡œ ë¹„êµ. ì˜ì¡´ì„±ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ë¦¬ë Œë”ë§ë§ˆë‹¤ Effectê°€ ë‹¤ì‹œ ì‹¤í–‰ë¨

> Object.isì—ì„œ ê°™ì€ ê°’ì´ë¼ê³  íŒì •ë˜ëŠ” ê²½ìš°

- both undefined
- both null
- both true or both false
- both strings of the same length with the same characters in the same order
- both the same object (**meaning both values reference the same object in memory**)
- both BigInts with the same numeric value
- both symbols that reference the same symbol value
- both numbers and
  - both +0
  - both -0
  - both NaN
    or both non-zero, not NaN, and have the same value

useEffectëŠ” undefinedë¥¼ ë°˜í™˜í•œë‹¤. sideEffectë§Œ ì‹¤í–‰ì‹œí‚¤ê³  ì¢…ë£Œë˜ëŠ” í•¨ìˆ˜ê°€ undefinedë¥¼ ë°˜í™˜í•˜ëŠ” ê±°ë‘ ê°™ì€ ë§¥ë½ì¸ë“¯.

useEffect ì“¸ ë•Œ ì£¼ì˜ì‚¬í•­

- ì»´í¬ë„ŒíŠ¸ì˜ ìµœìƒìœ„ ë ˆë²¨ì—ì„œë§Œ ì“°ì
- ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë™ê¸°í™”í•˜ë ¤ëŠ” ëª©ì ì´ ì•„ë‹ˆë¼ë©´ í•„ìš” ì—†ì„ ìˆ˜ë„ ìˆë‹¤.
- strict ëª¨ë“œ ì¼œì„œ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ í´ë¦°ì—… ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í•œë‹¤.(strict ëª¨ë“œ ì“°ë©´ ì…‹ì—… + í´ë¦°ì—…ì„ í•œë²ˆ ì‹¤ì œ ì…‹ì—…ì „ì— í•˜ëŠ”ë° ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ì„)
- ì˜ì¡´ì„± ì¤‘ ì¼ë¶€ê°€ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ì •ì˜ëœ **ê°ì²´** ë˜ëŠ” **í•¨ìˆ˜**ì´ë©´ Effectê°€ í•„ìš” ì´ìƒìœ¼ë¡œ ì‹¤í–‰ë  ìˆ˜ ìˆìŒ

---

ìŠ¤ëƒ…ìƒ· : ë Œë”ë§ ë‹¹ì‹œì˜ stateë¥¼ ì‚¬ìš©í•´ ê³„ì‚°

```jsx
function handleClick() {
  setAge(age + 1); // setAge(42 + 1)
  setAge(age + 1); // setAge(42 + 1)
  setAge(age + 1); // setAge(42 + 1)
}
// ì´ëŸ°ê±° ì¨ë„ í•œë²ˆ ë°–ì— ë‚˜ì´ ì¦ê°€ ì•ˆë¨

function handleClick() {
  setAge((a) => a + 1); // setAge(42 => 43)
  setAge((a) => a + 1); // setAge(43 => 44)
  setAge((a) => a + 1); // setAge(44 => 45)
}
//ì´ë ‡ê²Œ ì¨ì•¼ ì¦ê°€ë¨
//a=>a+1 ì´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë¼ì„œ ëŒ€ê¸°ì¤‘ì¸ stateë¥¼ ê°€ì ¸ì™€ì„œ ë‹¤ìŒ stateë¥¼ ê³„ì‚°í•˜ê¸° ë•Œë¬¸
```

---

ìœ„ì™€ ê°™ì´ age + 1 ëŒ€ì‹ ì— a=>a+1ì„ ì¨ì¤˜ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆìŒ. (1ì´ˆë§ˆë‹¤ countë¥¼ ëŠ˜ë ¤ì„œ í‘œì‹œí•˜ê³  ì‹¶ì€ë° ì˜ì¡´ì„±ì— countê°€ ë“¤ì–´ìˆìœ¼ë©´ ì…‹ì—…, í´ë¦°ì—…, ì…‹ì—…, í´ë¦°ì—…... ì´ë˜ì•¼ í•˜ë‹ˆê¹Œ c=>c+1ì„ ì¨ì„œ ë¦¬ì•¡íŠ¸ ì—…ë°ì´íŠ¸ íì—ì„œ stateë¥¼ ì“°ê³  ì˜ì¡´ì„±ì€ ì œê±°) ì•„ë‹ˆë©´ useEffectEvent ê°™ì€ê±° ì“°ê±°ë‚˜

- Effectê°€ ìƒí˜¸ì‘ìš©(í´ë¦­ê°™ì€ê±°)ìœ¼ë¡œ ì¸í•œ ê²ƒì´ ì•„ë‹ˆë¼ë©´, ì—…ë°ì´íŠ¸ëœ í™”ë©´ì´ ë¨¼ì € ê·¸ë ¤ì§€ê³  Effectë¥¼ ì‹¤í–‰í•¨. Effectê°€ ì‹œê°ì ì¸ ì‘ì—…ì„ í•˜ê³  ìˆê³ , ì§€ì—°ì´ ëˆˆì— ë„ëŠ” ê²½ìš°(ê¹œë¹¡ì„) [useLayoutEffect](https://react-ko.dev/reference/react/useLayoutEffect)(í™”ë©´ì´ ë‹¤ì‹œ ê·¸ë ¤ì§€ëŠ” ê²ƒì„ ë°©ì§€. ê·¼ë° useEffectë³´ë‹¤ ì†ë„ ì¢€ ëŠë¦¼)ë¥¼ ì“°ì.

- ìƒí˜¸ì‘ìš©ìœ¼ë¡œ ì¸í•´ Effectê°€ ë°œìƒí•´ë„ ë¸Œë¼ìš°ì €ëŠ” Effect ë‚´ë¶€ì˜ state ì—…ë°ì´íŠ¸ ì²˜ë¦¬ ì „ì— í™”ë©´ì„ ë‹¤ì‹œ ê·¸ë¦´ ìˆ˜ ìˆë‹¤. ë§Œì•½ í™”ë©´ì„ ë‹¤ì‹œ ì¹ í•˜ì§€ ëª»í•˜ë„ë¡ ì°¨ë‹¨í•´ì•¼ í•˜ëŠ” ê²½ìš°ë¼ë©´ useLayoutEffectë¥¼ ì“°ì

ì‚¬ìš©ë²•

- [ì™¸ë¶€ ì‹œìŠ¤í…œì— ì—°ê²°í•˜ê¸°](https://react-ko.dev/reference/react/useEffect#connecting-to-an-external-system). ì˜ˆì‹œì—ì„œëŠ” ì±„íŒ€ë°© ì‚¬ë¡€ê°€ ë‚˜ì˜¨ë‹¤.ê³„ì† ì±„íŒ…ë°©ì„ ì˜®ê²¨ë‹¤ë‹ë•Œ ì—°ê²° ëŠê³  ë‹¤ì‹œ ë°›ê³  í•´ì•¼í•˜ë‹ˆê¹Œ.

  - ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ì— "useEffect í•œë²ˆë§Œ ìˆ˜í–‰ë  ìˆ˜ ìˆê²Œ í•˜ëŠ” ë°©ë²•ì´ ìˆì„ê¹Œìš”?" ì— ëŒ€í•œ ëŒ€ë‹µìœ¼ë¡œ "í•œë²ˆë§Œ ì‹¤í–‰ì‹œí‚¤ëŠ” ë°©ë²•ì„ ì°¾ì§€ ë§ê³  ë‘ë²ˆ ì‹¤í–‰ë˜ë„ ë©€ì©¡í•˜ê²Œ ì½”ë“œ ì§œë¼" ë¼ê³  í•¨
  - ëª¨ë“  Effectë¥¼ ë…ë¦½ì ì¸ í”„ë¡œì„¸ìŠ¤ë¡œ ì‘ì„±í•˜ê³  í•œ ë²ˆì— í•˜ë‚˜ì˜ ì…‹ì—…/í´ë¦°ì—… ì£¼ê¸°ë§Œ ìƒê°í•´ë¼

- note

  - setInterval() ë° clearInterval()ë¡œ ê´€ë¦¬ë˜ëŠ” íƒ€ì´ë¨¸.
  - window.addEventListener() ë° window.removeEventListener()ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ë²¤íŠ¸ êµ¬ë….
  - animation.start() ë° animation.reset()ê³¼ ê°™ì€ APIê°€ ìˆëŠ” íƒ€ì‚¬ ì• ë‹ˆë©”ì´ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬.
    ì™€ ê°™ì€ ê²ƒë“¤ì€ Effect ì“°ì
  - DOM ì¡°ì‘ì‹œì—ë„ ì‚¬ìš©(ëª¨ë‹¬ì œì–´ê°™ì€ê±°)

- ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë¹¼ë©´ ë” ì¶”ìƒí™” ë ˆë²¨ì´ ë‚®ì€ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
- Reactê°€ ì•„ë‹Œ ìœ„ì ¯ ì œì–´
- ë°ì´í„° í˜ì¹­ í•  ë•Œ(ì¡°ê±´ê²½í•©ì´ ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•˜ëŠ”ë°, ë°ì´í„°ê°€ ë¶ˆëŸ¬ì™€ì§€ëŠ” íƒ€ì´ë°ì— ìƒê´€ì´ ì—†ì–´ì§„ë‹¤ëŠ” ëœ» ê°™ë‹¤.)

  - ê·¸ëŸ°ë° useEffectì—ì„œ ë°ì´í„° í˜ì¹­ì„ ë§ì´í•˜ë©´ ìµœì í™”ê°€ ì–´ë ¤ì›Œì§ˆ ìˆ˜ë„ ìˆìŒ
  - ssrì— ì“°ì§€ëª»í•œë‹¤ë˜ì§€, ìºì‹±ì„ í•  ìˆ˜ ì—†ë‹¤ë˜ì§€, ìƒìš©êµ¬ ì½”ë“œ(ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸)ê°€ ë§ì´ í•„ìš”í•˜ë‹¤ë˜ì§€
  - ê·¸ë˜ì„œ frameworkì˜ ë°ì´í„°í˜ì¹­ ë©”ì»¤ë‹ˆì¦˜ì„ ì´ìš©í•œë‹¤ë˜ì§€, client-side ìºì‹œë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ êµ¬ì¶•í•œë‹¤ë˜ì§€(ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬, ë¦¬ì•¡íŠ¸ë¼ìš°í„° ë“±ë“±) í•˜ì

- ì˜ì¡´ì„±ì´ í•„ìš”ì—†ëŠ” ê²½ìš°ëŠ” ëª…ì‹œì ìœ¼ë¡œ ë¹ˆ ë°°ì—´ì„ ë„£ì–´ì£¼ì. ì•„ì˜ˆ ì•ˆë„£ì–´ì¤„ìˆ˜ë„ ìˆì§€ë§Œ ë¦¬ë Œë”ë§ì´ í•„ìš”í•˜ì§€ ì•Šì€ ìƒí™©ì—ì„œë„ ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚  ìˆ˜ ìˆë‹¤.

- ë Œëœì´ ì¤‘ì— ìƒì„±ëœ ê°ì²´ë¥¼ ì˜ì¡´ì„±ìœ¼ë¡œ í•˜ì§€ ë§ê³ , useEffect ë‚´ë¶€ì—ì„œ ê°ì²´ë¥¼ ìƒì„±í•˜ì. ê·¸ë˜ì•¼ ë¦¬ë Œë”ë§ì‹œ ë¶ˆí•„ìš”í•˜ê²Œ useEffectê°€ ì‚¬ìš©ë˜ëŠ” ê²½ìš°ë¥¼ ë§‰ì„ ìˆ˜ ìˆë‹¤.

```jsx
const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId }) {
  const [message, setMessage] = useState('');

  const options = { // ğŸš© This object is created from scratch on every re-render
    serverUrl: serverUrl,
    roomId: roomId
  };

  useEffect(() => {
    const connection = createConnection(options); // It's used inside the Effect
    connection.connect();
    return () => connection.disconnect();
  }, [options]); // ğŸš© As a result, these dependencies are always different on a re-render
  // ...
```

- í•¨ìˆ˜ë„ ë§ˆì°¬ê°€ì§€ë¡œ useEffect ë‚´ì—ì„œ ì“°ì

! stateê°€ useEffect ì•ˆì—ì„œ ì—…ë°ì´íŠ¸ ë˜ê³  ê·¸ stateê°€ ì˜ì¡´ì„±ì´ë©´ ë¬´í•œë Œë”ë§ì— ê±¸ë¦°ë‹¤
